{% extends 'base.html' %}

{% block title %}Housekeeping Task Details{% endblock %}

{% block content %}
<h2>ğŸ§¹ Housekeeping Task Details</h2>

<div style="margin-bottom: 20px;">
    <a href="{% url 'housekeeping_list' %}" class="btn">â† Back to List</a>
</div>

<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 20px;">
        <div>
            <h3 style="color: #667eea; margin-bottom: 5px;">{{ task.task_number }}</h3>
            <p style="color: #666; margin: 0;">{{ task.get_area_type_display }} - {{ task.area_description }}</p>
        </div>
        <span class="badge {% if task.status == 'completed' %}badge-success{% elif task.status == 'in_progress' %}badge-warning{% else %}badge-info{% endif %}">
            {% if task.status == 'completed' %}âœ…{% elif task.status == 'in_progress' %}â³{% else %}ğŸ“‹{% endif %}
            {{ task.get_status_display|upper }}
        </span>
    </div>
    
    <div style="background: rgba(102, 126, 234, 0.1); padding: 15px; border-radius: 10px; margin-bottom: 20px;">
        <p style="margin: 5px 0;"><strong>ğŸ‘¤ Assigned To:</strong> {{ task.assigned_to.username }}</p>
        <p style="margin: 5px 0;"><strong>ğŸ“… Created:</strong> {{ task.created_at|date:"Y-m-d H:i" }}</p>
        {% if task.started_at %}
        <p style="margin: 5px 0;"><strong>ğŸ• Started:</strong> {{ task.started_at|date:"Y-m-d H:i" }}</p>
        {% endif %}
        {% if task.completed_at %}
        <p style="margin: 5px 0;"><strong>âœ… Completed:</strong> {{ task.completed_at|date:"Y-m-d H:i" }}</p>
        <p style="margin: 5px 0;"><strong>â±ï¸ Duration:</strong> {{ task.duration }}</p>
        {% endif %}
    </div>
    
    {% if task.status == 'in_progress' and not task.completed_at %}
    <div style="margin-bottom: 20px;">
        <a href="{% url 'housekeeping_complete' task.pk %}" class="btn btn-success" style="width: 100%; text-align: center;">âœ… Complete Task & Upload After Picture</a>
    </div>
    {% endif %}
</div>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-top: 30px;">
    <!-- Before Section -->
    <div class="card" style="border-left: 5px solid #ffc107;">
        <h3 style="color: #ffc107;">ğŸ“¸ Before Cleaning</h3>
        
        {% if task.before_image %}
        <div style="margin: 15px 0;">
            <img src="{{ task.before_image.url }}" alt="Before cleaning" style="width: 100%; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
        </div>
        {% else %}
        <div style="background: rgba(255, 193, 7, 0.1); padding: 30px; text-align: center; border-radius: 10px; margin: 15px 0;">
            <div style="font-size: 48px; margin-bottom: 10px;">ğŸ“·</div>
            <p style="color: #999;">No before picture uploaded</p>
        </div>
        {% endif %}
        
        {% if task.before_notes %}
        <div style="background: rgba(255, 193, 7, 0.1); padding: 15px; border-radius: 10px; margin-top: 15px;">
            <h4 style="color: #ffc107; margin-bottom: 10px;">ğŸ“ Before Notes</h4>
            <p style="white-space: pre-line;">{{ task.before_notes }}</p>
        </div>
        {% endif %}
    </div>
    
    <!-- After Section -->
    <div class="card" style="border-left: 5px solid #28a745;">
        <h3 style="color: #28a745;">âœ¨ After Cleaning</h3>
        
        {% if task.after_image %}
        <div style="margin: 15px 0;">
            <img src="{{ task.after_image.url }}" alt="After cleaning" style="width: 100%; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
        </div>
        {% else %}
        <div style="background: rgba(40, 167, 69, 0.1); padding: 30px; text-align: center; border-radius: 10px; margin: 15px 0;">
            <div style="font-size: 48px; margin-bottom: 10px;">ğŸ“·</div>
            <p style="color: #999;">
                {% if task.status == 'completed' %}
                No after picture uploaded
                {% else %}
                After picture will be uploaded when task is completed
                {% endif %}
            </p>
        </div>
        {% endif %}
        
        {% if task.after_notes %}
        <div style="background: rgba(40, 167, 69, 0.1); padding: 15px; border-radius: 10px; margin-top: 15px;">
            <h4 style="color: #28a745; margin-bottom: 10px;">ğŸ“ After Notes</h4>
            <p style="white-space: pre-line;">{{ task.after_notes }}</p>
        </div>
        {% endif %}
    </div>
</div>

{% if task.cleaning_products_used or task.issues_found %}
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-top: 20px;">
    {% if task.cleaning_products_used %}
    <div class="card" style="border-left: 5px solid #17a2b8;">
        <h3 style="color: #17a2b8;">ğŸ§´ Cleaning Products Used</h3>
        <p style="white-space: pre-line; margin-top: 15px;">{{ task.cleaning_products_used }}</p>
    </div>
    {% endif %}
    
    {% if task.issues_found %}
    <div class="card" style="border-left: 5px solid #dc3545;">
        <h3 style="color: #dc3545;">âš ï¸ Issues Found</h3>
        <p style="white-space: pre-line; margin-top: 15px;">{{ task.issues_found }}</p>
    </div>
    {% endif %}
</div>
{% endif %}

{% endblock %}
