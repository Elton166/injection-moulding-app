{% extends 'base.html' %}

{% block title %}Troubleshooting{% endblock %}

{% block content %}
<h2>ğŸ”§ Troubleshooting</h2>

<div style="margin: 20px 0;">
    <a href="{% url 'troubleshooting_log_create' %}" class="btn btn-danger">â• Log New Issue</a>
    <a href="{% url 'troubleshooting_chart' %}" class="btn btn-success">ğŸ“Š View Troubleshooting Chart</a>
</div>

<h3>ğŸ“š Common Issues & Solutions</h3>
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin-bottom: 30px;">
    {% for issue in issues %}
    <div class="card" style="border-left: 4px solid #667eea;">
        <h4 style="color: #667eea;">{{ issue.title }}</h4>
        <span class="badge badge-info">{{ issue.get_category_display }}</span>
        <p style="margin: 10px 0; font-size: 14px;">{{ issue.description|truncatewords:15 }}</p>
        <a href="{% url 'troubleshooting_detail' issue.pk %}" class="btn" style="padding: 5px 10px; font-size: 12px; width: 100%;">View Solution</a>
    </div>
    {% empty %}
    <p>No troubleshooting guides available</p>
    {% endfor %}
</div>

<h3>ğŸ“ Recent Issues Logged</h3>
<table>
    <thead>
        <tr>
            <th>Issue</th>
            <th>Mould</th>
            <th>Machine</th>
            <th>Operator</th>
            <th>Status</th>
            <th>Date</th>
        </tr>
    </thead>
    <tbody>
        {% for log in logs %}
        <tr>
            <td>{{ log.issue.title }}</td>
            <td>{{ log.mould }}</td>
            <td>{{ log.machine_number }}</td>
            <td>{{ log.operator.username }}</td>
            <td>
                {% if log.resolved %}
                <span class="badge badge-success">Resolved</span>
                {% else %}
                <span class="badge badge-danger">Open</span>
                {% endif %}
            </td>
            <td>{{ log.created_at|date:"Y-m-d H:i" }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="6" style="text-align: center; padding: 30px; color: #999;">
                <div style="font-size: 48px; margin-bottom: 10px;">âœ…</div>
                No issues logged
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
