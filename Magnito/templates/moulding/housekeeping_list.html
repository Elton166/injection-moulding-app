{% extends 'base.html' %}

{% block title %}Housekeeping Tasks{% endblock %}

{% block content %}
<h2>ğŸ§¹ Housekeeping Tasks</h2>

<div style="margin: 20px 0;">
    <a href="{% url 'housekeeping_create' %}" class="btn btn-success">â• Start New Housekeeping Task</a>
    <a href="{% url 'dashboard' %}" class="btn">â† Back to Dashboard</a>
</div>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 30px 0;">
    <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
        <h3 style="color: white;">ğŸ“‹ Pending</h3>
        <p style="font-size: 48px; font-weight: 700; margin: 10px 0;">{{ pending.count }}</p>
    </div>
    
    <div class="card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white;">
        <h3 style="color: white;">â³ In Progress</h3>
        <p style="font-size: 48px; font-weight: 700; margin: 10px 0;">{{ in_progress.count }}</p>
    </div>
    
    <div class="card" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); color: white;">
        <h3 style="color: white;">âœ… Completed</h3>
        <p style="font-size: 48px; font-weight: 700; margin: 10px 0;">{{ completed.count }}</p>
    </div>
</div>

<h3 style="margin-top: 40px;">ğŸ“‹ All Housekeeping Tasks</h3>

{% if tasks %}
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; margin: 20px 0;">
    {% for task in tasks %}
    <div class="card" style="border-left: 5px solid {% if task.status == 'completed' %}#28a745{% elif task.status == 'in_progress' %}#ffc107{% else %}#667eea{% endif %};">
        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px;">
            <div>
                <h4 style="color: #667eea; margin-bottom: 5px;">{{ task.task_number }}</h4>
                <p style="color: #666; font-size: 14px; margin: 0;">{{ task.get_area_type_display }}</p>
            </div>
            <span class="badge {% if task.status == 'completed' %}badge-success{% elif task.status == 'in_progress' %}badge-warning{% else %}badge-info{% endif %}">
                {% if task.status == 'completed' %}âœ…{% elif task.status == 'in_progress' %}â³{% else %}ğŸ“‹{% endif %}
                {{ task.get_status_display|upper }}
            </span>
        </div>
        
        <div style="background: rgba(102, 126, 234, 0.1); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
            <p style="margin: 5px 0;"><strong>ğŸ“ Area:</strong> {{ task.area_description }}</p>
            <p style="margin: 5px 0;"><strong>ğŸ‘¤ Assigned:</strong> {{ task.assigned_to.username }}</p>
            <p style="margin: 5px 0;"><strong>ğŸ“… Created:</strong> {{ task.created_at|date:"Y-m-d H:i" }}</p>
            {% if task.completed_at %}
            <p style="margin: 5px 0;"><strong>â±ï¸ Duration:</strong> {{ task.duration }}</p>
            {% endif %}
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px;">
            <div style="text-align: center; padding: 10px; background: rgba(255, 193, 7, 0.1); border-radius: 8px;">
                {% if task.before_image %}
                <div style="font-size: 24px;">ğŸ“¸</div>
                <p style="font-size: 12px; margin: 5px 0; color: #666;">Before</p>
                {% else %}
                <div style="font-size: 24px; opacity: 0.3;">ğŸ“·</div>
                <p style="font-size: 12px; margin: 5px 0; color: #999;">No Before</p>
                {% endif %}
            </div>
            <div style="text-align: center; padding: 10px; background: rgba(40, 167, 69, 0.1); border-radius: 8px;">
                {% if task.after_image %}
                <div style="font-size: 24px;">âœ¨</div>
                <p style="font-size: 12px; margin: 5px 0; color: #666;">After</p>
                {% else %}
                <div style="font-size: 24px; opacity: 0.3;">ğŸ“·</div>
                <p style="font-size: 12px; margin: 5px 0; color: #999;">No After</p>
                {% endif %}
            </div>
        </div>
        
        <div style="display: flex; gap: 10px;">
            <a href="{% url 'housekeeping_detail' task.pk %}" class="btn" style="flex: 1; text-align: center; padding: 8px;">View</a>
            {% if task.status == 'in_progress' %}
            <a href="{% url 'housekeeping_complete' task.pk %}" class="btn btn-success" style="flex: 1; text-align: center; padding: 8px;">âœ… Complete</a>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="card" style="text-align: center; padding: 40px;">
    <div style="font-size: 64px; margin-bottom: 15px;">ğŸ§¹</div>
    <p style="color: #999; margin-bottom: 20px;">No housekeeping tasks yet</p>
    <a href="{% url 'housekeeping_create' %}" class="btn btn-success">ğŸš€ Start First Task</a>
</div>
{% endif %}

{% endblock %}
